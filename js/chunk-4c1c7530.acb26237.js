(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c1c7530"],{"29ad":function(t,e,a){"use strict";var n=a("f886"),i=a.n(n);i.a},"4c90":function(t,e,a){"use strict";var n=a("7476"),i=a.n(n);i.a},"6ea2":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[t._l(t.articleList,(function(e){return a("article",{key:e.kanban+"-"+e.id,on:{click:function(a){return t.getArticle(e)}}},[a("div",{staticClass:"wrapper"},[a("span",[t._v(t._s(e.name)+" 、 "+t._s(e.time))]),a("h3",[t._v(t._s(e.title))]),a("p",[t._v(t._s(e.content))]),a("footer",[a("div",{staticClass:"mood",on:{click:function(a){return a.stopPropagation(),t.handkeClickMood(e,t.userInfo.name)}}},[a("awesome-icon",{attrs:{icon:["fas","heart"]}}),a("span",[t._v(" "+t._s(e.mood?e.mood.length:0))])],1),a("div",{staticClass:"react"},[a("awesome-icon",{attrs:{icon:["fas","comment"]}}),a("span",[t._v(" "+t._s(e.reaction?e.reaction.length:0))])],1),a("div",{staticClass:"collect",class:{opacity:t.userIsCollect(e)},on:{click:function(a){return a.stopPropagation(),t.handkeClickCollect(e,t.userInfo.uid)}}},[a("awesome-icon",{attrs:{icon:["fas","bookmark"]}}),a("span",[t._v(" 收藏")])],1)])]),a("div",{staticClass:"picture"},[a("img",{attrs:{src:"https://picsum.photos/200/200?random="+e.sortTime}})])])})),a("dialog-page",{attrs:{visible:t.openDialog,"min-width":"720px",height:"100vh"},on:{"update:visible":function(e){t.openDialog=e}}},[t.openDialog?a("div",{ref:"detail",staticClass:"detail"},[a("div",{staticClass:"main"},[a("h1",{staticClass:"username"},[t._v(t._s(t.articleData.name)+" ")]),a("h1",{staticClass:"title"},[t._v(t._s(t.articleData.title))]),a("div",{staticClass:"subtitle"},[a("span",[t._v(t._s(t.articleData.kanban))]),a("span",[t._v(t._s(t.articleData.time))])]),a("p",[t._v(t._s(t.articleData.content))])]),t._l(t.articleData.reaction,(function(e,n){return a("div",{key:n,staticClass:"comments__item"},[a("span",[t._v(t._s(e.name)+" :")]),a("span",[t._v(t._s(e.reaction))])])}))],2):t._e(),a("div",{staticClass:"bottom"},[a("awesome-icon",{directives:[{name:"show",rawName:"v-show",value:t.openReaction,expression:"openReaction"}],staticClass:"close",attrs:{icon:["fas","times"]},on:{click:function(e){return t.closeReaction()}}}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.reaction,expression:"loading.reaction"}],staticClass:"reaction"},[a("awesome-icon",{staticClass:"user",attrs:{icon:["fas","user"]}}),a("span",[t._v(t._s(t.userInfo.name))]),a("div",{staticClass:"react",style:{visibility:t.visibility},on:{click:function(e){return t.expandReaction()}}},[t._v("回應...")]),a("awesome-icon",{staticClass:"icon",class:{dialog_mood:t.hasMood},attrs:{icon:["fas","heart"]},on:{click:function(e){return t.handkeClickMood(t.articleData,t.userInfo.name)}}}),a("awesome-icon",{staticClass:"icon",class:{dialog_collect:t.hasCollect},attrs:{icon:["fas","bookmark"]},on:{click:function(e){return t.handkeClickCollect(t.articleData,t.userInfo.uid)}}})],1),t.openReaction?[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.submitData.reaction,expression:"submitData.reaction"}],ref:"textarea",attrs:{placeholder:"回應..."},domProps:{value:t.submitData.reaction},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.postReaction(t.articleData,t.submitData,e)},input:function(e){e.target.composing||t.$set(t.submitData,"reaction",e.target.value)}}}),a("div",{staticClass:"submit"},[a("button",{on:{click:function(e){return t.postReaction(t.articleData,t.submitData)}}},[t._v("送出")])])]:t._e()],2)])],2)},i=[],o=(a("4de4"),a("7db0"),a("c740"),a("a434"),a("b0c0"),a("96cf"),a("1da1")),s=a("5530"),r=a("2f62"),c=a("d443"),l=a("9a7a"),u=a("e2c9"),d={name:"article-item",components:{dialogPage:u["a"]},props:{data:{type:Array,required:!0}},data:function(){return{loading:{page:!1,reaction:!1},debounce:!1,hasMood:!1,hasCollect:!1,openDialog:!1,openReaction:!1,articleData:null,submitData:{},KANBAN_LIST:c["c"]}},computed:Object(s["a"])(Object(s["a"])({},Object(r["d"])(["userInfo"])),{},{visibility:function(){return this.openReaction?"hidden":"visible"},articleList:function(){return this.data.filter(Boolean)}}),watch:{openDialog:function(t){t||(this.articleData=null,this.openReaction=!1,this.submitData.reaction="")},articleData:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(null!==t){a.next=2;break}return a.abrupt("return");case 2:return n=e.userInfo,a.next=5,e.$database.hasMood(t,n.name);case 5:return e.hasMood=a.sent,a.next=8,e.$database.hasCollect(t,n.uid);case 8:e.hasCollect=a.sent;case 9:case"end":return a.stop()}}),a)})))()}},created:function(){this.initSubmit()},methods:Object(s["a"])(Object(s["a"])({},Object(r["b"])(["setUserInfo"])),{},{initSubmit:function(){this.submitData={name:this.userInfo.name,reaction:""}},getArticle:function(t){this.openDialog=!0,this.articleData=t},handkeClickMood:function(t,e){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.loading.page=!0,a.loading.reaction=!0,n.next=4,a.$database.hasMood(t,e);case 4:if(a.hasMood=n.sent,!a.hasMood){n.next=12;break}return n.next=8,a.$database.subMood(t,e);case 8:i=t.mood.findIndex((function(t){if(t)return t.name===e})),t.mood.splice(i,1),n.next=16;break;case 12:return n.next=14,a.$database.addMood(t,e);case 14:o={id:t.mood?t.mood.length:0,name:e},void 0===t.mood?t.mood=[o]:t.mood.push(o);case 16:return n.next=18,a.$database.hasMood(t,e);case 18:a.hasMood=n.sent,a.$forceUpdate(),a.loading.reaction=!1,a.loading.page=!1;case 22:case"end":return n.stop()}}),n)})))()},handkeClickCollect:function(t,e){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.loading.page=!0,a.loading.reaction=!0,n.next=4,a.$database.hasCollect(t,e);case 4:if(a.hasCollect=n.sent,i=Object(l["a"])(a.userInfo),!a.hasCollect){n.next=14;break}return n.next=9,a.$database.subCollect(t,e);case 9:o=i.collect.findIndex((function(e){if(e)return e.id===t.id&&e.kanban===t.kanban})),i.collect.splice(o,1),a.setUserInfo(i),n.next=19;break;case 14:return n.next=16,a.$database.addCollect(t,e);case 16:void 0===i.collect&&(i.collect=[]),i.collect.push(t),a.setUserInfo(i);case 19:return n.next=21,a.$database.hasCollect(t,e);case 21:a.hasCollect=n.sent,a.loading.reaction=!1,a.loading.page=!1;case 24:case"end":return n.stop()}}),n)})))()},expandReaction:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.openReaction=!0,e.next=3,t.$nextTick();case 3:t.$refs.textarea.focus();case 4:case"end":return e.stop()}}),e)})))()},closeReaction:function(){this.openReaction=!1},postReaction:function(t,e,a){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!a.shiftKey&&!n.debounce){i.next=2;break}return i.abrupt("return");case 2:return n.debounce=!0,o=n.formatter(t.kanban),void 0===t.reaction?t.reaction=[e]:t.reaction.push(e),i.next=7,n.$database.setReaction(o,t.id,e);case 7:n.rollInBottom(),n.closeReaction(),n.initSubmit(),n.debounce=!1;case 11:case"end":return i.stop()}}),i)})))()},userIsCollect:function(t){if(void 0!==this.userInfo.collect&&null!==t){var e=this.userInfo.collect.find((function(e){if(e)return e.id===t.id&&e.kanban===t.kanban})),a=e||null;return a}},rollInBottom:function(){var t=this.$refs.detail;t.scrollTo({top:t.scrollHeight,behavior:"smooth"})},formatter:function(t){var e="home",a=c["c"].data.find((function(e){return e.name===t}));return void 0!==a&&(e=a.code),e}})},f=d,h=(a("29ad"),a("2877")),m=Object(h["a"])(f,n,i,!1,null,"3a5b2d5e",null);e["a"]=m.exports},7476:function(t,e,a){},"9a7a":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));a("99af"),a("d3b7");var n=function(t){var e=JSON.parse(JSON.stringify(t));return e},i=function(){var t=new Date,e="".concat(t.getMonth()+1,"月").concat(t.getDate(),"日 ").concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds());return e}},a434:function(t,e,a){"use strict";var n=a("23e7"),i=a("23cb"),o=a("a691"),s=a("50c4"),r=a("7b0b"),c=a("65f0"),l=a("8418"),u=a("1dde"),d=a("ae40"),f=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,p=Math.min,v=9007199254740991,b="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!f||!h},{splice:function(t,e){var a,n,u,d,f,h,g=r(this),k=s(g.length),w=i(t,k),x=arguments.length;if(0===x?a=n=0:1===x?(a=0,n=k-w):(a=x-2,n=p(m(o(e),0),k-w)),k+a-n>v)throw TypeError(b);for(u=c(g,n),d=0;d<n;d++)f=w+d,f in g&&l(u,d,g[f]);if(u.length=n,a<n){for(d=w;d<k-n;d++)f=d+n,h=d+a,f in g?g[h]=g[f]:delete g[h];for(d=k;d>k-n+a;d--)delete g[d-1]}else if(a>n)for(d=k-n;d>w;d--)f=d+n-1,h=d+a-1,f in g?g[h]=g[f]:delete g[h];for(d=0;d<a;d++)g[d+w]=arguments[d+2];return g.length=k-n+a,u}})},e2c9:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"mask",on:{click:function(e){return t.changeVisible()}}},[a("div",{ref:"dialog",staticClass:"dialog",on:{click:function(t){t.stopPropagation()}}},[a("div",{staticClass:"close"},[a("awesome-icon",{attrs:{icon:["fas","times"]},on:{click:function(e){return t.changeVisible()}}})],1),t._t("default")],2)])},i=[],o=(a("4160"),a("b64b"),a("159b"),{name:"dialog-page",props:{width:{type:String,default:"500px"},minWidth:{type:String,default:""},maxWidth:{type:String,default:""},height:{type:String,default:""},visible:{type:Boolean,default:!1},radius:Boolean},watch:{visible:function(t){document.body.style.overflow=t?"hidden":"auto"}},mounted:function(){this.initAttr()},methods:{initAttr:function(){var t=this,e={width:this.width,minWidth:this.minWidth,maxWidth:this.maxWidth,height:this.height};Object.keys(e).forEach((function(a){t.$refs.dialog.style[a]=e[a]})),this.radius&&(this.$refs.dialog.style["borderRadius"]="1rem")},changeVisible:function(){this.$emit("update:visible",!1)}}}),s=o,r=(a("4c90"),a("2877")),c=Object(r["a"])(s,n,i,!1,null,"8a47e896",null);e["a"]=c.exports},f886:function(t,e,a){}}]);
//# sourceMappingURL=chunk-4c1c7530.acb26237.js.map